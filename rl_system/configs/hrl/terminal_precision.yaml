# Terminal Specialist PRECISION Training Configuration v2
# OBJECTIVE: Train terminal specialist to achieve <50m miss distance
#
# KEY FIXES from v1:
# - Curriculum now updates correctly (train_hrl_pretrain.py fixed)
# - Start at 100m where we succeed, progress to 25m
# - Longer training (2M steps) with gentler curriculum
# - Use base environment rewards (they work well)

# Inherit base settings
parent_config: ../../config.yaml

# Specialist-specific training
training:
  total_timesteps: 2000000  # 2M steps for proper curriculum progression
  n_envs: 12  # More parallel environments (you have 16 cores)
  n_steps: 2048  # Longer rollouts for credit assignment
  batch_size: 512  # Larger batch for better GPU utilization
  use_subproc: false  # Disabled - causes CUDA conflicts. DummyVecEnv + GPU is faster

  # Learning parameters
  learning_rate: 0.0003  # Standard PPO LR (works well)
  gamma: 0.99  # Standard gamma
  gae_lambda: 0.95

  # Moderate entropy - need some exploration to find precision
  ent_coef: 0.01
  ent_coef_final: 0.001
  ent_decay_steps: 1500000

  # Network architecture
  net_arch: [512, 512, 256]
  use_lstm: false  # MLP with frame-stack (more stable)
  use_layer_norm: true
  use_orthogonal_init: true
  frame_stack: 4

  # Evaluation settings
  eval_freq: 25000
  n_eval_episodes: 20
  checkpoint_freq: 50000

# PRECISION CURRICULUM: 100m -> 25m over 2M steps
# Gentler progression to avoid catastrophic forgetting
curriculum:
  enabled: true
  initial_radius: 100.0   # Start where we succeed (verified 18% at 100m)
  final_radius: 25.0      # Target: 25m precision (realistic for missiles)
  curriculum_steps: 2000000  # Match total_timesteps for full progression

  # Progression timeline:
  # Step 0:        100m (consolidate current capability)
  # Step 500k:     81m  (25% progress)
  # Step 1000k:    62m  (50% progress)
  # Step 1500k:    44m  (75% progress)
  # Step 2000k:    25m  (100% - precision target)

# Environment - use standard config (don't change spawn positions)
# The base config already has good spawn geometry
environment:
  max_steps: 2000  # Standard episode length
