# Terminal Specialist - 360° with Rotation-Invariant Observations
#
# KEY INNOVATION: rotation_invariant=true transforms all vectors to body frame
# This makes observations independent of absolute world orientation,
# allowing the model to generalize to missiles from ANY direction
#
# OBSERVATION SPACE (still 26D, but different meaning):
# [0-2]: Relative position in BODY FRAME [forward, right, up]
# [3-5]: Relative velocity in BODY FRAME [forward, right, up]
# [6-8]: Interceptor velocity in BODY FRAME [forward, right, up]
# [9-11]: Zeros (orientation is implicit in body frame)
# [12-16]: Scalars (fuel, TTI, quality, closing rate, off-axis) - unchanged
# [17-22]: Ground radar in BODY FRAME
# [23-25]: Quality metrics - unchanged
#
# Target: Sub-50m precision with full 360° coverage

parent_config: ../../config.yaml

training:
  total_timesteps: 3000000  # 3M steps
  n_envs: 16
  n_steps: 2048
  batch_size: 512
  use_subproc: false

  learning_rate: 0.0003
  gamma: 0.99
  gae_lambda: 0.95
  ent_coef: 0.01

  net_arch: [512, 512, 256]
  use_lstm: false
  use_layer_norm: true
  use_orthogonal_init: true
  frame_stack: 4

  eval_freq: 25000
  n_eval_episodes: 20
  checkpoint_freq: 100000

environment:
  max_steps: 2000

  # ROTATION-INVARIANT OBSERVATIONS
  rotation_invariant: true

  # PROXIMITY FUZE: 50m kill radius
  proximity_fuze_enabled: true
  proximity_kill_radius: 50.0

  # SPHERICAL SPAWN: Full 360° coverage
  missile_spawn:
    position_mode: "spherical"
    radius_min: 800.0
    radius_max: 1500.0
    azimuth_range: [0, 360]
    elevation_range: [15, 60]
    velocity_mode: "toward_target"
    speed_min: 80.0
    speed_max: 150.0
    # Fallback box
    position: [[800, 800, 800], [1500, 1500, 1500]]
    velocity: [[-60, -60, -30], [-100, -100, -50]]

curriculum:
  enabled: true
  initial_radius: 200.0
  final_radius: 50.0
  curriculum_steps: 2500000
  precision_mode: true
